---
title: "Chocolatey + VirtualBox + Vagrant ã®ç°¡å˜ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— ï¼ˆWindowsï¼‰"
emoji: "ğŸ“"
type: "tech"
topics: chocolatey VirtualBox Vagrant Windows8
published: true
---

## 10åˆ†ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ãã‚‹ç°¡å˜æ‰‹é † :smile: 
### Windows8 ã« Vagrantã‚’å…¥ã‚Œã¦ã¿ã‚‹,ãã—ã¦GitHubã«ã‚¢ã‚¯ã‚»ã‚¹
æœ€è¿‘ã¯ã€LAMPç’°å¢ƒã‚‚ä½¿ã„æ¨ã¦ã¨ã„ã†ã‹CIãƒ„ãƒ¼ãƒ«(Jekinsã¨ã‹ï¼‰ã¨çµ„ã¿åˆã‚ã›ã¦ãƒ†ã‚¹ãƒˆé§†å‹•å‹ã§ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆãƒ»ç ´æ£„ãªã‚“ã¦ã„ã†ã®ãŒæµè¡Œã£ã¦ã„ãŸã‚Šã‚‚ã—ã¾ã™ãŒã€Vagrant ä½¿ã†ã¨ã•ã£ãã‚Šä»®æƒ³ç’°å¢ƒï¼ˆä»¥ä¸‹ VMï¼‰ã‚’ä½œæˆã§ãã‚‹ã‚ˆã¨ã„ã†ã®ã§è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚ã¾ãŸä½œæˆã—ãŸ Vagrant ç’°å¢ƒã‹ã‚‰ Github ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã¾ã™ã€‚

## Vagrant ã®è¨­å®š
### Chocolatey ã®å°å…¥
[Chocolatey](https://chocolatey.org/)ã¯ã€Windowsç‰ˆ yum ã£ã¦ã„ã†æ„Ÿã˜ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚ã“ã‚Œã‚’å°å…¥ã—ã¦ãŠãã¨ã„ã¡ã„ã¡ã‚¢ãƒ—ãƒªã‚’ããã£ãŸã‚Šã—ãªãã¦ã„ã„ã®ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã‚‚ç°¡å˜ã§ã™ã®ã§ã¾ãšã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

1. [https://chocolatey.org/](https://chocolatey.org/)ã‚µã‚¤ãƒˆã«è¡Œãã€dosçª“ç”¨(C:\> ã®ã‚„ã¤)ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚
2. dosçª“ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
3. ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

### VirtualBox ã¨ Vagrant ã®å°å…¥
å°å…¥ã—ãŸ[Chocolatey](https://chocolatey.org/)ã§ VirtualBox ã¨ Vagrant ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ã€ç‰¹ã«æ°—ã«ãªã‘ã‚Œã°Chocolateyã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ã‚‹æœ€æ–°ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚
dosçª“ã‚’é–‹ã„ã¦ã€ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å©ãã ã‘ã€‚

```
C:\> cinst virtualbox
C:\> cinst vagrant
```

### ã‚²ã‚¹ãƒˆOSã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
[Vagrantå…¬å¼ã‚µã‚¤ãƒˆ](http://www.vagrantbox.es/) ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯¾è±¡ã®ã‚²ã‚¹ãƒˆOSã‚’é¸æŠã—ã¦ãŠãã¾ã™ã€‚ã¾ãŸ Vagrant ã§ä½œæˆã™ã‚‹VMã¯ã€ **Windowsãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå˜ä½ã§ä½œæˆ** ã•ã‚Œã‚‹ãŸã‚é©å½“ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§Vagrantã§VMä½œæˆã™ã‚‹ã¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ²¢å±±ã•ã‚Œã¦ã—ã¾ã†ã®ã§æ³¨æ„ï¼ˆãƒ‡ã‚£ã‚¹ã‚¯ã‚‚æ²¢å±±ã‚ã‚‹ãªã‚‰æ°—ã«ã—ãªã„ã§ã„ã„ã‘ã©ã­ï½—ï¼‰ã€‚
ã¾ãšã¯ã€VM ã¨ã—ã¦CentOSã‚’èµ·å‹•ã—ã¦ã¿ã‚‹

* [Chef](http://www.getchef.com/chef/) ,[Puppet](http://puppetlabs.com/) ãŒå§‹ã‚ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ç´ ã® CentOS 6.5 x86_64(2014/5æ™‚ç‚¹ã§) ã‚’å…¥ã‚Œã¦ã¿ã¾ã™ã€‚â€»Chef, Puppet ã¯ã€å¾Œè¨˜ã™ã‚‹ã®ã§ã€Œãµãƒ¼ã‚“ãƒ¼ã€ä½ã§æµã—ã¦ãŠã„ã¦ok
* vagrantã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã¿ã¦ãŠãã€‚

 ```
 $ vagrant box add {title} {url}
 $ vagrant init {title}
 $ vagrant up
 ```
* å®Ÿéš›ã®ã‚³ãƒãƒ³ãƒ‰ï¼ˆã“ã‚Œã ã‘ï¼‰

 ```
C:\> cd C:\Users\<userå>
C:\> mkdir vagrant
C:\> cd vagrant
C:\> vagrant box add centos6.5 https://github.com/2creatives/vagrant-centos/releases/download/v6.5.3/centos65-x86_64-20140116.box
C:\> vagrant init centos6.5
C:\> vagrant up
 ```

### ã‚²ã‚¹ãƒˆOSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹
ã€Œvagrant upã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã€ä¸‹è¨˜ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

```
Host: 127.0.0.1
Port: 2222
Username: vagrant
Private key: C:/Users/<userå>/.vagrant.d/insecure_private_key
```

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚½ãƒ•ãƒˆ teraterm, putty ãªã©ã§ã‚²ã‚¹ãƒˆOSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã™ã€‚

```
Host: 127.0.0.1
Port: 2222
id:vagrand â† pw ã‚‚åŒã˜
```
### è¤‡æ•°ã®VMã‚’èµ·å‹•ã—ã¦ã¿ã‚‹
ç”¨é€”ã«å¿œã˜ãŸVMã‚’è¤‡æ•°èµ·å‹•ã—ãŸã„å ´åˆã¯ã€```Vagrantfile``` ã«ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã€‚Vagrantèµ·å‹•ãƒ›ã‚¹ãƒˆï¼ˆã“ã“ã§ã¯ã€windowsï¼‰ã®ã€port:2222, 2223 ã« ãã‚Œãã‚Œ web1, web2 ã® ssh(22)ã‚’ forward ã™ã‚‹å®šç¾©ã¨ã—ã¦è¨˜è¿°ã—ã¦ã¿ã‚‹ã€‚

```lang:Vagrantfile
Vagrant.configure("2") do |config|
  config.vm.box = "CentOS6.5"
  config.vm.box_url = "https://github.com/2creatives/vagrant-centos/releases/download/v6.5.3/centos65-x86_64-20140116.box"
 
  config.vm.define :web1 do |web1|
    web1.vm.network :forwarded_port, guest: 22, host: 2222, host_ip: "127.0.0.1", id: "ssh", auto_correct: true
  end
 
  config.vm.define :web2 do |web2|
    web2.vm.network :forwarded_port, guest: 22, host: 2223, host_ip: "127.0.0.1", id: "ssh", auto_correct: true
  end
end
```

web1, web2 ã‚’èµ·å‹•ã—ã¦ã¿ã‚‹ã€‚ã‚³ãƒãƒ³ãƒ‰ã¯ ```vargrant up web1``` ```vargrant up web2```

web1, web2 ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹ã€‚

```
web1 Host: 127.0.0.1, Port: 2222
web2 Host: 127.0.0.1, Port: 2223
```

æ˜ç¤ºçš„ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã—ãŸã„å ´åˆã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æŒ‡å®šã‚’è¿½åŠ 

```
web1.vm.network :private_network, ip: "192.168.1.11"
web2.vm.network :private_network, ip: "192.168.1.12"
```

## vagrant ã‚³ãƒãƒ³ãƒ‰
èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ ```vagrant up```
çµ‚äº†ã‚³ãƒãƒ³ãƒ‰ ```vagrant halt```
ä»®æƒ³ç’°å¢ƒbox ```vagrant box list```
ä»®æƒ³ç’°å¢ƒã®çŠ¶æ…‹ ```vagrant status```
ç’°å¢ƒã‚’ç ´æ£„ã—ãŸã„ã¨ã ```vagrant destroy```

##  ã“ã“ã¾ã§10åˆ†â€¦ã¨ã¯ã„ã‚ãªã„ã‘ã©
Chocolatey ã®å°å…¥ã¨Vagrant 10åˆ†ã§ã¯ç„¡ç†ã‹ã‚‚ã—ã‚Œãªã„ã‘ã©ã€20åˆ†ã‚ã‚Œã°ç°¡å˜ã«ä½œã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚

# å¤ã„Chocolateyã‹ã‚‰æœ€æ–°ç‰ˆã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã¨ãã®ä¸å…·åˆ

```
The default install location has been changed to 'C:\ProgramData\chocolatey'.
This install will be updated to that location in the next version. It
is strongly suggested you move this installation to the new location
as soon as possible to limit write access from all users. Do not forget
to update PATH & ChocolateyInstall environment variables.
```

ã®ã‚¨ãƒ©ãƒ¼ã¨ã„ã†ã‹é–“é•ã£ã¦ã‚‹ãœã„ã‚ã‚Œã‚‹ã®ã§ã€ä¸‹è¨˜ã‚’å‚ç…§ã«ã—ãªãŒã‚‰å¯¾å‡¦ã™ã‚‹ã€‚
https://github.com/chocolatey/chocolatey/wiki/Migrate-Old-Chocolatey-Directory-to-ProgramData


---
title: "CentOS 6.6 ã« rbenvã‚’åˆ©ç”¨ã—ãŸ Ruby 2.2.0 + Ruby on Rails 4.2.0 ç’°å¢ƒæ§‹ç¯‰"
emoji: "ğŸ“"
type: "tech"
topics: Ruby CentOS6.x Vagrant Rails
published: true
---

## Ruby, Ruby on Rails ã®ç’°å¢ƒæ§‹ç¯‰
ã¡ã‚‡ã„ã¨ Ruby é–¢ä¿‚ã®ã‚¢ãƒ¬ã‚’ã—ãªã„ã¨ã„ã‘ãªã„ã®ã§ä¹…ã—ã¶ã‚Šã«ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¦ã¿ã¾ã—ãŸã€‚ã¾ãŸæ¤œè¨¼ã‚‚å…¼ã­ã¦ãªã®ã§ rbenv ã‚’ä½¿ç”¨ã—ç•°ãªã‚‹rubyã‚’ä½¿ã„åˆ†ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ãªç’°å¢ƒã‚’æ•´ãˆã¾ã™ã€‚

| ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|:-----------|:----------|
|rbenv       |0.4.0-129-g7e0e85b     | 
|Ruby        |2.2.0p0    |
|Rails       |4.2.0     | 


## å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
git ã‚„ã‚‚ã‚ã‚‚ã‚ã‚¤ãƒ³ã‚¹ã‚³ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã®ã§åˆã‚ã«ã‚¤ãƒ³ã‚¹ã‚³ã—ã¾ã™ã€‚
bash ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä½œæ¥­ã—ã¦ã¾ã™ãŒ zsh ã§ã‚‚åŒæ§˜ã«ã„ã‘ã‚‹ã¯ãšã§ã™ã€‚

```
$ sudo yum install zlib zlib-devel openssl-devel sqlite-devel gcc-c++ glibc-headers libyaml-devel readline readline-devel zlib-devel libffi-devel
```

## git ã‹ã‚‰ rbenv, ruby-build ã‚’ clone

```
$ git clone https://github.com/sstephenson/rbenv.git ~/.rbenv
$ git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
```

.bash_profile ã«ä»¥ä¸‹ã‚’è¿½åŠ ã— ```source .bash_profile``` ã‚’å®Ÿè¡Œã€‚

```lang:.bash_profile
export PATH=$PATH:$HOME/.rbenv/bin:$HOME/.rbenv/shims
```

rbenv ãŒæ­£ã—ãå®Ÿè¡Œã§ãã‚‹ã‹ç¢ºèª

```
$ . ~/.bash_profile
$ rbenv -v
rbenv 0.4.0-129-g7e0e85b
```

## Ruby ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rbenv ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ ruby ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹ã€‚2.xç³»ã®å®‰å®šç‰ˆã¯ã€2015/1/20æ™‚ç‚¹ã§ [2.2.0](https://www.ruby-lang.org/ja/downloads/) ãªã®ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼ˆçµæ§‹ã€æ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰ã€‚

```
$ rbenv install --list
$ rbenv install 2.2.0
```

ã‚¨ãƒ©ãƒ¼ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããªã„å ´åˆã€Results logged ã§ç¤ºã•ã‚Œã¦ã„ã‚‹logã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã€‚ã‚ãŸã—ã¯ã€libffi.a ãŒç„¡ã„ã‚ˆã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã§ã—ãŸã®ã§ç´ ç›´ã« ```sudo yum install libffi-devel``` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—å•é¡Œè§£æ±ºã—ã¾ã—ãŸã€‚

```
Last 10 log lines:
make[3]: Leaving directory `/tmp/ruby-build.20150119155252.15788/ruby-2.2.0/ext/fiddle/libffi-3.2.1'
linking shared-object fiddle.so
/usr/bin/ld: ./libffi-3.2.1/.libs/libffi.a(raw_api.o): relocation R_X86_64_32 against `.text' can not be used when making a shared object; recompile with -fPIC
./libffi-3.2.1/.libs/libffi.a: could not read symbols: Bad value
```

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ ruby ã«ç’°å¢ƒã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
ä¸Šè¨˜ rbenv ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ ruby ã«ç’°å¢ƒã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚
ä¸‹è¨˜ã®æ§˜ã«ãªã‚‰ãªã„å ´åˆã¯ã€ç’°å¢ƒå¤‰æ•°ã®å®šç¾©ã‚’è¦‹ç›´ã™ã“ã¨ã€‚

```
$ rbenv rehash
$ ruby -v
rbenv: version `system' is not installed
$ rbenv global 2.2.0
$ rbenv version
2.2.0 (set by /home/vagrant/.rbenv/version)
$ ruby -v
ruby 2.2.0p0 (2014-12-25 revision 49005) [x86_64-linux]
```

## Ruby on Rails ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ã‚ã¨å°‘ã—ï½—

```
$ gem update --system
$ gem install --no-ri --no-rdoc rails
$ gem install bundler
$ rbenv rehash
```

ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹

```
$ rails -v
Rails 4.2.0
```

## WEBrick ã‚’èµ·å‹•ã™ã‚‹
Ruby on Rails ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚’ä½œæˆã— WEBrick ã®èµ·å‹•ãŒã§ãã‚‹ã‹ç¢ºèªã™ã‚‹ã€‚

```
$ rails new sample --skip-bundle
$ cd sample
$ bundle install
```

WEBrick ã®èµ·å‹•ã§ã‚¨ãƒ©ãƒ¼ãŒã§ã‚‹ã‚ˆ
â€»JavaScriptã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒå¿…è¦ã ã¨ã„ã†ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€node.js ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
$ rails s 
/home/vagrant/.rbenv/versions/2.2.0/lib/ruby/gems/2.2.0/gems/execjs-2.2.2/lib/execjs/runtimes.rb:51:in `autodetect': Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)
```

node.js ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€[ã„ã¤ã‚‚ã®ç”»é¢](https://www.google.co.jp/search?q=ruby+on+rails+%E5%88%9D%E6%9C%9F%E7%94%BB%E9%9D%A2&espv=2&biw=1205&bih=794&source=lnms&tbm=isch&sa=X&ei=C769VIedKKHsmAXe0YDQCA&ved=0CAYQ_AUoAQ)ãŒè¡¨ç¤ºå‡ºæ¥ã¦ã„ã‚Œã°å•é¡Œãªã—ã€‚

```
$ sudo yum install nodejs npm â€“enablerepo=epel
$ rails s
```

## Vagrantç’°å¢ƒã® WEBrick ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„
æ˜ç¤ºçš„ã« port, ip ã‚’æŒ‡å®šã™ã‚‹ã€‚

```
$ rails s -p 3000 -b 192.168.11.206
```

## å‚è€ƒã«ã•ã›ã¦é ‚ã„ãŸã‚µã‚¤ãƒˆ
> [railsç’°å¢ƒæ§‹ç¯‰ï¼ˆCentOS + ruby on railsï¼‰](http://qiita.com/shinyashikis@github/items/3501c5f7f71a8e345c3d)
> [CentOSã«Ruby on Railsã®ç’°å¢ƒæ§‹ç¯‰ã¨ã‹](http://qiita.com/ayihis@github/items/4e809244a4f666ac45bb)
> [rbenvã§è¤‡æ•°ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®rubyã‚’ä½¿ç”¨ã™ã‚‹ç’°å¢ƒã‚’æ•´ãˆã‚‹](http://memo.yomukaku.net/entries/ApoFwmf)


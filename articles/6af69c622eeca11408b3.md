---
title: "CentOS7.3 ç’°å¢ƒ(Vagrant)ã« SchemaSpy ã‚’å°å…¥ã—ã¦ã¿ã‚‹ã®å·»"
emoji: "ğŸ“"
type: "tech"
topics: centos7 Vagrant schema
published: true
---

# SchemaSpy ã£ã¦ãªã‚“ã˜ã‚ƒã„
ä»Šã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±ãƒ»ERå›³ã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ã‚’å‡ºåŠ›ã—ã¦ãã‚Œã‚‹ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã„ã¾ã¾ã§ã®çµŒé¨“ä¸Šã€ãƒã‚°ã¨ã‹ç™ºç”Ÿã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¿®æ­£ã™ã‚‹ã‚‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã£ã¦æ›´æ–°ã•ã‚Œãªã„ã“ã¨ãŒå¤šã„ã‚“ã§ã™ã‚ˆã€ã¨ãã«ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã£ã¦èª°ã‚‚æ›´æ–°ã—ãªã‹ã£ãŸã‚Šã™ã‚‹ã‚“ã§ã™ã‚ˆã­ã€ã€ã€‚ã¾ã‚ã‚ã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€”ä¸­ã§å‚åŠ ã—ãŸã‘ã©ãã†ã„ã£ãŸè¨­è¨ˆè³‡æ–™ãŒã‚¼ãƒ­ã£ã¦ã¨ã“ã‚‚ã‚ã‚‹ã—ã€‚ã¾ã‚ã€ãã†ã„ã†è¨³ã§ã“ã†ã„ã†ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ãŒã‚ã‚‹ã¨ã„ã„ã‚ã‘ã§ã™ï½—ã€‚

# SchemaSpy å‹•ä½œå‰ææ¡ä»¶
ã¨ã‚Šã‚ãˆãšã€Java8 ãŒã‚ã‚Œã°ã„ã‘ã‚‹ã£ã½ã„ã€‚ãƒªãƒ¬ã‚·ãƒ§ãƒ¼ãƒ³ã‚·ãƒƒãƒ—ã¯ã€graphviz ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãã‚‰ã„ã‹ãªã€‚ã¨ã‚Šã‚ãˆãšã­ã€‚
ã‚ã¨Javaãªã®ã§å¥½ããªç’°å¢ƒã§ä½¿ãˆã°ã„ã„ã¨æ€ã„ã¾ã™ã€‚

| ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|:-----------|:----------|
|JAVA    |8      | 
|ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹|Mysql,Oracle(default),DB2 ...    |
|schemaspy|6.0.0-rc1     | 
|Graphviz|2.38.0     | 

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
http://schemaspy.readthedocs.io/en/latest/home.html

schemaspy ã¨ã€MySQL ã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã€æç”»ã™ã‚‹ãŸã‚ã® graphviz ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```
/home/vagrant/dbspy
â”œâ”€â”€ /html
â”œâ”€â”€ schemaspy-6.0.0-rc1.jar
â””â”€â”€ mysql-connector-java-5.1.43-bin.jar
```

## schemaspy ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ã¨ã‚Šã‚ãˆãšã€ã“ã‚“ãªæ„Ÿã˜ã§ã€‚okã€‚æœ€æ–°ç‰ˆå…¥ã‚Œã‚Œã°ã„ã„ã¨æ€ã†ã‚ˆã€‚

```bash
$ mkdir dbspy
$ cd dbspy
$ wget https://github.com/schemaspy/schemaspy/releases/download/v6.0.0-rc1/schemaspy-6.0.0-rc1.jar
$ mkdir html
```

## MySQL ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚ã£ã¦ã»ã©ã˜ã‚ƒãªã„ã‘ã©ã­ï½—ã€‚

```bash:
$ cd dbspy
$ wget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.43.tar.gz
$ tar zxvf mysql-connector-java-5.1.43.tar.gz
$ cp mysql-connector-java-5.1.43/mysql-connector-java-5.1.43-bin.jar .
```

## graphviz ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
[CentOS 7ã«graphvizã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](http://qiita.com/ynaito/items/efc2dc2085482dfceac5) ã•ã‚“ã®æ‰‹é †ã¨ãŠã‚Šã«é€²ã‚ã‚Œã°okã€‚

```bash:
$ wget http://www.graphviz.org/graphviz-rhel.repo
$ sudo cp ./graphviz-rhel.repo /etc/yum.repos.d/
$ sudo yum install graphviz-2.38.0-1.el7
$ sudo yum install graphviz-graphs-2.38.0-1.el7
$ sudo yum install graphviz-gd-2.38.0-1.el7
$ sudo yum install graphviz-devel-2.38.0-1.el7
$ sudo yum install graphviz-lang-python-2.38.0-1.el7
```

# config.file ã‚’ä½œæˆã—ã¦ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã™ã‚‹ã€‚

```text:config.file
# type of database. Run with -dbhelp for details
schemaspy.t=mysql
# optional path to alternative jdbc drivers.
schemaspy.dp=/home/vagrant/dbspy/mysql-connector-java-5.1.43-bin.jar
# database properties: host, port number, name user, password
schemaspy.host=server
schemaspy.port=3306
schemaspy.db=db_name
schemaspy.u=database_user
schemaspy.p=database_password
# output dir to save generated files
schemaspy.o=/home/vagrant/dbspy/html
# db scheme for which generate diagrams
schemaspy.s=dbo
```

ã¨ã€dbæ¥ç¶šæƒ…å ±ãªã©ä¿®æ­£ã—ã¦â€¦ã€‚
ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

```bash:
$ cd dbspy
$ java -jar schemaspy-6.0.0-rc1.jar -configFile config.file
```

å®Ÿè¡ŒçµæœãŒãšã‚‰ãšã‚‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ã‹ãã‚Šã¯ã€html ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ—¢å­˜ã®DBã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

http://schemaspy.org/sample/index.html

# ä½¿ã£ãŸæ„Ÿæƒ³
400ãƒ†ãƒ¼ãƒ–ãƒ«æ•°ã‚ã‚‹æ—¢å­˜ã®DBã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆã—ãŸã¨ã“ã‚ã€ç´„ï¼’æ™‚é–“ä½ã‹ã‹ã‚Šã¾ã—ãŸã€‚çµæœã¨ã—ã¦æ‰‹ãƒ¡ãƒ³ãƒ†ã™ã‚‹è³‡æ–™ã‚ˆã‚Šå…¨ç„¶ã‚¤ã‚±ãƒ†ãƒ«ã®ã§é€±æœ«ã ã‚Œã‚‚ä½¿ã£ã¦ã„ãªã„ç’°å¢ƒã§å®Ÿè¡Œã—ã¦ãŠãã¨ã‹ã„ã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚

# å‚è€ƒã«ã•ã›ã¦é ‚ã„ãŸã‚µã‚¤ãƒˆæ§˜
> [SchemaSpy - æ—¢å­˜ã®DBã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ](http://www.moongift.jp/2017/07/schemaspy-%E6%97%A2%E5%AD%98%E3%81%AEdb%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E3%81%8B%E3%82%89%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E7%94%9F%E6%88%90/)
> [CircleCI x SchemaSpyã§ERå›³ã‚’æ–°ã—ãã—ç¶šã‘ã‚‹](http://hatappi.hateblo.jp/entry/2017/03/28/083000)












---
title: "Apache Solr ã§ã‚µã‚¸ã‚§ã‚¹ãƒˆã‚’å®Ÿç¾ã—ã¦ã¿ã‚‹ã€ãã®ï¼’"
emoji: "ğŸ“"
type: "tech"
topics: Solr
published: true
---

# google å…ˆç”Ÿã®ã‚ã‚Œã§ã™ã€ã‚ã‚Œ
ã“ã‚Œã€ã“ã‚Œã€‚ã‚µã‚¸ã‚§ã‚¹ãƒˆæ©Ÿèƒ½ã£ã¦googleå…ˆç”Ÿã§ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ã„ã‚‹ã€Œã“ã‚Œã§ã™ã‹ã­ï¼Ÿã€ã¨å€™è£œã‚’ç¤ºã—ã¦ãã‚Œã‚‹ã‚„ã¤ã§ã™ã‚ã€‚

![image](https://qiita-image-store.s3.amazonaws.com/0/44540/abd16dcc-a8d2-7e7d-cf15-442fff91b207.png)

# ã¨ã‚‚ã‹ãã™ã”ã„ã‚“ã§ã™
ã“ã®ã‚µã‚¸ã‚§ã‚¹ãƒˆæ©Ÿèƒ½ã¯ã€ç°¡å˜ãã†ã«è¦‹ãˆã¦ä»•çµ„ã¿ã‚’çŸ¥ã‚‹ã¨æ„å¤–ã¨é›£ã—ã„ä»•çµ„ã¿ãªã‚“ã ãªã¨ã€ã¾ã‚ã€Œæ™®é€šã€ãªã“ã¨ãŒè¤‡é›‘ãªä»•çµ„ã¿ã§å®Ÿè£…ãŒé¢å€’ã£ã¦ã„ã†ã®ã¯ã€ã‚ˆãã‚ã‚‹ã“ã¨ã§ã™ã­ï½—ã€‚

![image](https://qiita-image-store.s3.amazonaws.com/0/44540/0a1dac16-9adf-4d6e-ea81-98bf7317f19e.png)

è¦ã™ã‚‹ã« ajax ã‚’ä½¿ç”¨ã—ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã« Solr ã«å•ã„ã‚ã‚ã›ã—çµæœã‚’æç”»ã™ã‚‹ã€‚ã£ã¦ã„ã†ã“ã¨ã§ã™ã€‚

# è©¦ã—ã¦ã¿ã‚‹
[Solrã®Suggesterã‚’è©¦ã—ã¦ã¿ã‚‹](http://shinodogg.com/?p=5994) ã•ã‚“ã®ç´¹ä»‹è¨˜äº‹ã‚’å‚è€ƒã«ã•ã›ã¦é ‚ãã¤ã¤æ‰‹é †ã‚’è¿½ã£ã¦æ§‹ç¯‰ã—ã¦ã¿ã¾ã™ã€‚

ã¾ãšã€[Apache Solrï¼ˆJDK7, Solr 4.9.1, jetty 9ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ãŸãã®ï¼‘](http://qiita.com/murachi1208/items/9c9bd24294db66f6b49b) å‰å›è¨˜äº‹ã¨ãŠã‚Šã«ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã™ï¼ˆèµ·å‹•ã¯ã—ãªã„ã“ã¨ï¼‰ã€‚

# Solr ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®
[RONDHUITç¤¾](http://www.rondhuit.com/download.html)ã‚µã‚¤ãƒˆã®ã€["[æ”¹è¨‚æ–°ç‰ˆ] Apache Solrå…¥é–€ ~ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹å…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³â€](http://www.rondhuit.com/books/solr/solrbook-2.zip) ã‚’ã‚¯ãƒªãƒƒã‚¯ã— solrbook-2.zip ã‚’è§£å‡ã—ã¾ã™ã€‚

sampledata/suggester ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã®ã§ãã‚Œã‚’æ‰€å®šã®å ´æ‰€ã«ã‚³ãƒ”ãƒ¼ã— solr ã‚’èµ·å‹•ã—ã¾ã™ã€‚

```
# cp sampledata/suggester/conf/*.xml /var/local/solr/example/solr/collection1/conf
# service jetty start
```

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ã—ã¾ã™ã€‚

```
$ cd sampledata/suggester
$ curl 'http://localhost:8983/solr/collection1/update?commit=true&indent=true' --data-binary @sample-suggester.xml -H 'Content-Type: text/xml'
```

ã“ã‚Œã ã‘ã§ã™ï½—

# æ¤œç´¢ã—ã¦ã¿ã‚‹
ç®¡ç†ç”»é¢ã‚’é–‹ã„ã¦ã€Query ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚ã“ã®ã¨ã Request-Handler ã¯ã€Œ/autocomplete_jaã€ã€q ã«ã€Œshiã€ã‚’æŒ‡å®šã—ã¾ã™ã€‚

![image](https://qiita-image-store.s3.amazonaws.com/0/44540/8e7d7e90-0a5d-5030-f599-dce26427f0a6.png)

çµæœã¨ã—ã¦ "æ¸‹è°·", "æ–°æ©‹", "æ–°", "æ–°å¤§ä¹…ä¿"... ã¨ã€Œshiã€ã¨ãªã‚‹èª­ã¿ãŒæ¤œç´¢ã•ã‚Œã¾ã—ãŸã€‚ã€Œã—ã€ã§ã‚‚åŒã˜ã‚ˆã†ã«ãªã‚‹ã®ã§è‰²ã€…ã¨ã‚„ã£ã¦ã¿ã‚‹ã¨é¢ç™½ã„ã§ã™ã€‚

## curlã§å‘¼ã‚“ã§ã¿ã‚‹
ã¾ã‚ã€ãŠå¯Ÿã—ã®ã¨ãŠã‚Šã§ã™ãŒãƒ»ãƒ»ãƒ»

```
$ curl "http://localhost:8983/solr/collection1/autocomplete_ja?q=shi&wt=json"
{"responseHeader":{"status":0,"QTime":2},"spellcheck":{"suggestions":["shi",{"numFound":6,"startOffset":0,"endOffset":3,"suggestion":["æ¸‹è°·","æ–°æ©‹","æ–°","æ–°å¤§ä¹…ä¿","å“å·","æ–°å®¿"]},"collation","æ¸‹è°·"]}}
```

## /autocomplete_ja ã£ã¦ã©ã“ã«å®šç¾©ï¼Ÿ
solrconfig.xml ã® requestHandler ã« autocomplete_ja å‹•ä½œãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚ã“ã“ã‚‰ã‚’ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã¦ã„ãã“ã¨ã§è‡ªåˆ†ãªã‚Šã®æ¤œç´¢æ–¹æ³•ã‚’æ¨¡ç´¢ã—ãªãŒã‚‰å®šç¾©ã™ã‚‹ã®ã§ã—ã‚‡ã†ãŒã€ã‚ãŸã—ã‚‚æœ¬ã‚’è²·ã£ã¦å‹‰å¼·ä¸­ã§ã™ã®ã§è©³ã—ãã¯æœ¬ã‚’èª­ã‚€ã®ãŒæ—©ã„ã§ã™ã­ã€‚

# ã¨ã“ã‚ã§ã‚µã‚¸ã‚§ã‚¹ãƒˆæ©Ÿèƒ½ã®å®Ÿè£…æ–¹æ³•ã¯ï¼Ÿ
ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚Šã¾ã™ã®ã§ https://github.com/mosuka/solr-suggest-sample-ui ã‚’ clone ã—ã¦å®Ÿè¡Œã™ã‚‹ã®ãŒã‚ˆã‚ã—ã„ã‹ã¨ï¼
â€»ç§ã¯ã€ajax ãŒã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šæ€ã†ã‚ˆã†ã«å‹•ã‹ãªã‹ã£ãŸï½ï½

ã¨ã‚Šã‚ãˆãšã€‚apache ã§ã‚‚ãªã‚“ã§ã‚‚ã„ã„ã®ã§webã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã¾ã™ã€‚

```
$ git clone https://github.com/mosuka/solr-suggest-sample-ui
$ sudo cp -rp solr-suggest-sample-ui/suggest-sample/ /var/www/html/
```

ã§ã€index.html ã‚’å¤‰æ›´ã—ã¦ã€‚ã€‚ã€‚

```
url: "/solr/" + collection + "/terms",
â†“
url: "http://192.168.11.210:8983/solr/" + collection + "/terms",
```

ã‚€ã‚€ã€‚ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã†ã€‚ãªã‚“ã§ã ã‚ï¼Ÿ
ï¼ˆajax åˆ†ã‹ã£ã¦ãªã„ã®ã§ã„ã¾ã“ã“ã§ç«‹ã¡æ­¢ã¾ã£ã¦ã¾ã™ï½—ï¼‰

# è²·ã†ã¹ãæœ¬
[ï¼»æ”¹è¨‚æ–°ç‰ˆï¼½Apache Solrå…¥é–€â€•â€•ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹å…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³](https://books.google.co.jp/books?id=sotSAgAAQBAJ&pg=PA14&lpg=PA14&dq=apache+solr+%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%80%80%E6%97%A5%E6%9C%AC%E8%AA%9E&source=bl&ots=36RCholgUY&sig=aXK_AKMcWka_Foti_b60Ltrt5Fw&hl=ja&sa=X&ei=Gi8rVZL0HqHDmAWk6YC4DQ&ved=0CEMQ6AEwBg#v=onepage&q=apache%20solr%20&f=false)

# å‚è€ƒã«ã•ã›ã¦é ‚ã„ãŸã‚µã‚¤ãƒˆ
> [http://tree-tips.appspot.com/solr/](http://tree-tips.appspot.com/)
> [æ—¥æœ¬èªã€Œã‚‚ã—ã‹ã—ã¦ã€æ¤œç´¢ã«ã¤ã„ã¦](http://www.rondhuit.com/%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%80%8C%E3%82%82%E3%81%97%E3%81%8B%E3%81%97%E3%81%A6%E3%80%8D%E6%A4%9C%E7%B4%A2%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6.html)
> [Solrã§æ—¥æœ¬èªã®è‡ªå‹•è£œå®Œæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ãŒã€æ–‡ã®é€”ä¸­ã®å˜èªã§è£œå®ŒãŒå‹•ã‹ãªã„](http://qa.atmarkit.co.jp/q/9220)
> [jQueryUIã®autocompleteã‚’æ—¥æœ¬èªç¢ºå®šå¾Œã«å®Ÿè¡Œã•ã›ã‚‹æ–¹æ³•](http://ja.stackoverflow.com/questions/5126/jqueryui%E3%81%AEautocomplete%E3%82%92%E6%97%A5%E6%9C%AC%E8%AA%9E%E7%A2%BA%E5%AE%9A%E5%BE%8C%E3%81%AB%E5%AE%9F%E8%A1%8C%E3%81%95%E3%81%9B%E3%82%8B%E6%96%B9%E6%B3%95)
> [Apache Solrã‚’åˆ©ç”¨ã—ã¦æœ¬æ ¼çš„ãªæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å°å…¥ã™ã‚‹](http://ameblo.jp/itboy/entry-11521145965.html)


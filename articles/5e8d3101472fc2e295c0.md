---
title: "Nginx ã§ Digestèªè¨¼ãŒå‡ºæ¥ãªã‹ã£ãŸã®ã§ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã¿ãŸãœ"
emoji: "ğŸ“"
type: "tech"
topics: nginx Basicèªè¨¼ Digestèªè¨¼
published: true
---

# Digestèªè¨¼ãŒã§ããªã„ã®ï¼Ÿ
ã¡ã‚‡ã£ã¨Basicèªè¨¼ã ã¨[ã‚¢ãƒ¬](http://d.hatena.ne.jp/ozuma/20140905/1409850688)ãªã®ã§ã€Digestèªè¨¼ã‚’ä½¿ã„ãŸã„ãªã¨æ€ã£ãŸã‚‰æ¨™æº–ã§ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ã®ã­ã€‚ã¨ã€2012å¹´ä½ã®è©±é¡Œã‹ã‚‰ç¾åœ¨ã«è‡³ã‚‹ã¾ã§å¯¾å¿œã—ã¦ãªã„ãªã‚“ã¦ã€‚ãã‚“ãªã‚ã‘ã§ç¾çŠ¶ï¼ˆ2015/5)ã§ã‚‚ã€samizdatcoæ°ã®ä½œã£ãŸnginx-http-auth-digestã¨ã„ã†ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚

> [HttpAuthDigestModule](http://wiki.nginx.org/HttpAuthDigestModule) (Nginx Wiki)
> [Nginx Digest Authentication module](https://github.com/samizdatco/nginx-http-auth-digest/blob/master/readme.rst) (GitHub)

## Basicèªè¨¼ã ã¨ã‚¢ãƒ¬ãªã‚“ã ã‚ˆ
Basicèªè¨¼ã ã¨ã‚¢ãƒ¬ã£ã¦ã„ã†ã®ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ã®èªè¨¼éƒ¨åˆ†ãŒæš—å·åŒ–ã•ã‚Œã¦ã„ãªã„ã¨ã„ã†è©±ã§ã™ã€‚Chrome ã® [Developer Tools](http://www.d-wood.com/blog/2013/12/06_5088.html) ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€éƒ¨åˆ†ã‚’ã¿ã¦ã¿ã‚‹ã¨ä¸‹è¨˜éƒ¨åˆ†ãŒã‚ã£ã¦ã€ã“ã‚Œã‚’ã§ã‚³ãƒ¼ãƒ‰ã‹ã‘ã‚‹ã¨ã€‚ã€‚ã€‚ã‚ã‚‰ï½—

Authorization:Basic ZG9nOmRvZ2RvZw==

```
# echo "ZG9nOmRvZ2RvZw==" | base64 -d
dog:dogdog
```

ã¿ã‚Œã¡ã‚ƒã†ã®ã‚ˆã­ã€‚ãªã®ã§Digestèªè¨¼ã«ã™ã¹ãã¨ã€‚
ã—ã‹ã—èªè¨¼ã£ã¦å¤šç”¨ãªæš—å·åŒ–ãŒä½¿ãˆã‚‹ã£ã¦ã—ã‚‰ã‚“ã‹ã£ãŸã€‚

```
CRYPT , MD5 : Nginx åˆç‰ˆ ã‹ã‚‰ å¯¾å¿œ
apr1 , PLAIN , SSHA : Nginx 1.0.3 ã‹ã‚‰ å¯¾å¿œ
SHA : Nginx 1.3.13 ã‹ã‚‰ å¯¾å¿œ
```

> [Nginx ã§Basicèªè¨¼(ãƒ¦ãƒ¼ã‚¶åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ±‚ã‚ã‚‹ )ã™ã‚‹ã«ã¯](http://server-setting.info/centos/apache-nginx-7-basic-auth.html)

# Digestèªè¨¼ã‚½ãƒ¼ã‚¹ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
ãªã‚“ã ã‹ã“ã® http-auth-digest-module ã¯ã€bugãŒã‚ã‚‹ã‚‰ã—ãsamizdatcoæ°ãƒãƒ¼ã‚¸ã—ã¦ãªã„ã‚“ã ã‹ãªã‚“ã ã‹ãªã®ã§ï¼ˆãªã‚“ã ã‹ï½˜ï¼’å›ç›®ï½—ï¼‰ãƒ‘ãƒƒãƒã‚‚åŒæ™‚ã«ã‚ã¦ã¡ã‚ƒã„ã¾ã™ã€‚

> [[FreeBSD][nginx] http-auth-digestãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‘ãƒƒãƒ](http://tokcs.com/archives/1810)

å‰å›ã®[[Nginx ã§ WebDAV ç’°å¢ƒæ§‹ç¯‰ã€PROPFIND 405å‡ºã§ä½¿ãˆãªã‹ã£ãŸã®ã§ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã¿ãŸ](http://qiita.com/murachi1208/items/a67ae7b617d459e04615) ]ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ç’°å¢ƒã‚’å…ƒã«ã—ã¾ã™ã€‚

```
$ cd nginx-1.9.0
$ git clone https://github.com/samizdatco/nginx-http-auth-digest.git
$ cd nginx-http-auth-digest
$ git clone https://gist.github.com/frah/3921741 
$ patch -u < 3921741/patch-ngx_http_auth_digest_module.diff 
```

ãã—ã¦

```
$ ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-mail --with-mail_ssl_module --with-file-aio --with-ipv6 --with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic' --add-module=./nginx-dav-ext-module --add-module=./nginx-http-auth-digest 
$ make
$ sudo make install
```

# Digestèªè¨¼ã‚’è¨­å®š
Apache ã«ä»˜å±ã—ã¦ã„ã‚‹ htdigest ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã®ã ã‘ã©ã€```yum install httpd-tools``` ã¨ã™ã‚Œã°ã‚³ãƒãƒ³ãƒ‰ã ã‘ãŒå…¥ã‚‹ã®ã§å…ˆã«ã‚¤ãƒ³ã‚¹ã‚³ã—ã¦ãŠãã€‚
ãƒ¦ãƒ¼ã‚¶ï¼šhage, ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼šhagehage ã£ã¦æ„Ÿã˜ã§Digestèªè¨¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚
ã‚ã€ã‚ã¨ãƒ¬ã‚¢ãƒ ?ã¯ã€"digest realm-name" ã«ã¨ã‚Šã‚ãˆãšã—ã¨ãã¾ã™ã€‚

```
$ cd /etc/nginx
$ htdigest -c .htdigest 'digest realm-name' hage
```

ã‚ˆã—ã€‚ã§ããŸã€‚ã‚ã¨ Nginx ã®å®šç¾©ã¯ã€ã„ã‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

```
location / {
  # digestèªè¨¼
  auth_digest "digest realm-name";
  auth_digest_user_file /etc/nginx/.htdigest;
```

Nginx ã‚’å†èµ·å‹•ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹ã€‚

# ã¤ã„ã§ã«Basicèªè¨¼ã®è¨­å®šæ–¹æ³•
ã“ã£ã¡ã‚‚ Apache ã«ä»˜å±ã—ã¦ã„ã‚‹ htpasswd ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã€```yum install httpd-tools``` ã‚’å…ˆã«ã‚¤ãƒ³ã‚¹ã‚³ã—ã¦ãŠãã€‚
ãƒ¦ãƒ¼ã‚¶ï¼šhage, ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼šhagehage ã£ã¦æ„Ÿã˜ã§Basicèªè¨¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚ 

```
$ cd /etc/nginx
$ sudo htpasswd -c .htpasswd hage
```

ã‚ˆã—ã€‚ã§ããŸã€‚ã‚ã¨ Nginx ã®å®šç¾©ã¯ã€ã„ã‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

```
location / {
  # basicèªè¨¼
  auth_basic "Aurh Basic";
  auth_basic_user_file /etc/nginx/.htpasswd;
```






---
title: "GrowthForecast ã‚’CentOS6.5ï¼ˆVagrantï¼‰ã«å°å…¥ Supervisor ã—ã¦ã¿"
emoji: "ğŸ“"
type: "tech"
topics: growthforecast CentOS6.5 Vagrant supervisor upstart
published: true
---

# Supervisor ã£ã¦
é©å½“ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ‡ãƒ¼ãƒ¢ãƒ³åŒ–ã™ã‚‹ãŸã‚ã®ä¾¿åˆ©ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚```/etc/init.d/``` ä»¥ä¸‹ã«èµ·å‹•ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ãæ‰‹é–“ãŒç„¡ãã¦ã„ã„ï¼ï¼ ã‚ã¨ Supervisor ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ã‚‚ã—ã¦ãã‚Œã‚‹ã®ã§ãƒ—ãƒ­ã‚»ã‚¹ãŒæ­»ã‚“ã ã‚‰è‡ªå‹•çš„ã«å†èµ·å‹•ï¼ˆè¨­å®šæ¬¡ç¬¬ã§ã™ã‘ã©ã­ï¼‰ã—ã¦ãã‚Œã‚‹ã€‚
â€»è‡ªåˆ†ã§ç®¡ç†ã—ã¦ã‚‹ï¼ˆã§ãã‚‹ï¼‰ã‚µãƒ¼ãƒã˜ã‚ƒãªã„ã¨ã“ã†ã„ã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ å…¥ã‚Œã•ã›ã¦ãã‚Œãªã„ã‘ã©ã­ï½—

> [é©å½“ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ‡ãƒ¼ãƒ¢ãƒ³åŒ–ã™ã‚‹ã®ã«SupervisorãŒä¾¿åˆ©](http://d.hatena.ne.jp/anatoo/20120310/1331321778)

# Supervisor ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
easy_install ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ãŒ epel ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚[epel ãƒªãƒã‚¸ãƒˆãƒª](http://qiita.com/muniere/items/6c4923a070cbbd824f39) ã®è¿½åŠ ã¯ã€ã“ã“ã‚’ã¿ã¦è¨­å®šã™ã‚‹ã¨ã‚ˆã„ã§ã™ã€‚

```
# yum --enablerepo=epel install -y supervisor
```

Supervisor è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã—ã¾ã™ã€‚```/etc/supervisord.conf``` ã‚’é–‹ã„ã¦ä¸‹è¨˜ã®å†…å®¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```/etc/supervisord.conf
[program:growthforecast]
command=/home/growthforecast/perl5/perlbrew/perls/perl-5.20.0/bin/perl /home/growthforecast/perl5/perlbrew/perls/perl-5.20.0/bin/growthforecast.pl --port=5125 --data-dir /var/log/growthforecast/dataprocess_name=%(program_name)s
stdout_logfile_maxbytes=1MB
stderr_logfile_maxbytes=1MB
stdout_logfile=/var/log/supervisor/%(program_name)s.log
stderr_logfile=/var/log/supervisor/%(program_name)s.log
user=growthforecast
autostart=true
autorestart=true
```

# Supervisor ã‚’èµ·å‹•ã—ã¦ã¿ã‚‹
èµ·å‹•ã«å¤±æ•—ã—ã¦ã„ã‚‹å ´åˆã¯ ```/var/log/supervisor/supervisord.log``` ã‚’è¦‹ã¦ã¿ã‚‹ã€‚

```
# service supervisord start
supervisord ã‚’èµ·å‹•ä¸­:                                 [  OK  ]
# supervisorctl status
growthforecast RUNNING    pid 7716, uptime 0:00:07
# ps aux | grep supervisorctl 
ãšã‚‰ãšã‚‰ï½—
```

# Upstart ã§ supervisord ã‚’èµ·å‹•
å§‹ã‚ã‹ã‚‰ GrowthForecast ã‚’ Upstart ã§èµ·å‹•ã™ã‚Œã°ã‚ˆã„ã®ã§ã™ãŒã€supervisord ã‚‚ä¾¿åˆ©ãªã®ã§ç¶™ç¶šã—ã¦ä½¿ã„ã¾ã™ã€‚supervisord è‡ªèº«ãŒãŠäº¡ããªã‚Šã«ãªã£ãŸå ´åˆã¯ã©ã†ã—ã‚ˆã†ã‚‚ãªã„ã®ã§ã€Upstart ãŒå†å§‹å‹•ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚
ã¡ãªã¿ã« Upstart ã¯ã€RHEL/CentOS 6.0 ä»¥é™ã«å°å…¥ã•ã‚ŒãŸãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

> [Upstart ã‚’ä½¿ã£ã¦ãŠæ‰‹è»½ daemon åŒ–](http://heartbeats.jp/hbblog/2013/02/upstart-daemon.html)

```/etc/init/supervisord.conf
description "supervisord"
 
start on runlevel [2345]
stop on runlevel [!2345]
respawn
exec /usr/bin/supervisord -n
```

Upstart ã®ã‚³ãƒãƒ³ãƒ‰ã§ supervisord ã‚’èµ·å‹•ã—ã¾ã™ã€‚

```
# service supervisord stop
# initctl start supervisord
```

# GrowthForecast ã®ä½¿ã„æ–¹â€¦
ç’°å¢ƒå›ã‚Šã°ã‹ã‚Šã§ã€GrowthForecast ã®ä½¿ã„æ–¹ã‚’å¤±å¿µã—ã¦ã¾ã—ãŸæ±—

